            // Recalc    <input type="file" id="import-file" accept=".json,.csv" style="display: none;">

    <script>
        // Enhanced storage system using JavaScript objects (persistent during session)
        let taskStorage = {
            tasks: [],
            nextId: 1,
            
            save() {
                // In a real application, this would save to a secure backend
                // For now, we'll keep it in memory during the session
                this.updateStats();
                this.renderAllTasks();
            },
            
            load() {
                // Initialize with empty data or load from previous session
                this.updateStats();
                this.renderAllTasks();
            },
            
            addTask(task) {
                task.id = this.nextId++;
                task.createdAt = new Date().toISOString();
                task.completed = false;
                task.completedAt = null;
                this.tasks.push(task);
                this.save();
            },
            
            updateTask(id, updates) {
                const taskIndex = this.tasks.findIndex(t => t.id === id);
                if (taskIndex !== -1) {
                    this.tasks[taskIndex] = { ...this.tasks[taskIndex], ...updates };
                    this.save();
                    return true;
                }
                return false;
            },
            
            deleteTask(id) {
                this.tasks = this.tasks.filter(t => t.id !== id);
                this.save();
            },
            
            toggleComplete(id) {
                const task = this.tasks.find(t => t.id === id);
                if (task) {
                    task.completed = !task.completed;
                    task.completedAt = task.completed ? new Date().toISOString() : null;
                    this.save();
                }
            },
            
            updateStats() {
                const totalTasks = this.tasks.length;
                const completedTasks = this.tasks.filter(t => t.completed).length;
                const totalHours = this.tasks.reduce((sum, t) => sum + (parseFloat(t.estimatedTime) || 0), 0);
                const avgGraceScore = totalTasks > 0 
                    ? (this.tasks.reduce((sum, t) => sum + t.graceScore, 0) / totalTasks).toFixed(0)
                    : 0;
                
                document.getElementById('total-tasks').textContent = totalTasks;
                document.getElementById('completed-tasks').textContent = completedTasks;
                document.getElementById('avg-grace-score').textContent = avgGraceScore;
                document.getElementById('total-hours').textContent = totalHours.toFixed(1);
                
                // Update progress bar
                const progressPercent = totalTasks > 0 ? (completedTasks / totalTasks) * 100 : 0;
                document.getElementById('completion-progress').style.width = progressPercent + '%';
                
                // Update quadrant counts
                const quadrantCounts = { 1: 0, 2: 0, 3: 0, 4: 0, held: 0 };
                this.tasks.forEach(task => {
                    if (!task.completed) {
                        quadrantCounts[task.quadrant]++;
                    }
                });
                
                Object.keys(quadrantCounts).forEach(quadrant => {
                    const element = document.getElementById(`count-${quadrant}`);
                    if (element) {
                        element.textContent = quadrantCounts[quadrant];
                    }
                });
                
                // Update pie chart
                this.updatePieChart();
            },
            
            updatePieChart() {
                // Calculate time allocation for Do Now (quadrant 1) and Schedule (quadrant 2) tasks only
                const relevantTasks = this.tasks.filter(task => 
                    !task.completed && (task.quadrant === 1 || task.quadrant === 2)
                );
                
                const timeByCategory = {
                    'Church': 0,
                    'Family': 0,
                    'Work': 0,
                    'Relationships': 0,
                    'Self': 0
                };
                
                // Sum up hours by category
                relevantTasks.forEach(task => {
                    if (timeByCategory.hasOwnProperty(task.taskType)) {
                        timeByCategory[task.taskType] += parseFloat(task.estimatedTime) || 0;
                    }
                });
                
                const totalHours = Object.values(timeByCategory).reduce((sum, hours) => sum + hours, 0);
                
                if (totalHours === 0) {
                    document.getElementById('pie-chart-container').innerHTML = 
                        '<div class="no-data-message">Add tasks to "Do Now" or "Schedule" quadrants to see time allocation</div>';
                    document.getElementById('chart-legend').innerHTML = '';
                    return;
                }
                
                // Generate pie chart
                this.renderPieChart(timeByCategory, totalHours);
            },
            
            renderPieChart(timeByCategory, totalHours) {
                const colors = {
                    'Church': '#8e44ad',
                    'Family': '#e74c3c', 
                    'Work': '#3498db',
                    'Relationships': '#f39c12',
                    'Self': '#27ae60'
                };
                
                const icons = {
                    'Church': '⛪',
                    'Family': '👨‍👩‍👧‍👦',
                    'Work': '💼',
                    'Relationships': '🤝',
                    'Self': '🧘'
                };
                
                // Create SVG for pie chart
                const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                svg.setAttribute('viewBox', '0 0 200 200');
                
                let currentAngle = 0;
                const radius = 80;
                const centerX = 100;
                const centerY = 100;
                
                // Generate legend HTML
                let legendHTML = '';
                
                Object.entries(timeByCategory).forEach(([category, hours]) => {
                    if (hours > 0) {
                        const percentage = (hours / totalHours) * 100;
                        const angle = (hours / totalHours) * 360;
                        
                        // Create pie slice
                        const slice = this.createPieSlice(centerX, centerY, radius, currentAngle, currentAngle + angle, colors[category]);
                        svg.appendChild(slice);
                        
                        // Add to legend
                        legendHTML += `
                            <div class="legend-entry">
                                <div class="legend-color-dot" style="background-color: ${colors[category]}"></div>
                                <div class="legend-text">${icons[category]} ${category}</div>
                                <div class="legend-text">${percentage.toFixed(1)}%</div>
                            </div>
                        `;
                        
                        currentAngle += angle;
                    }
                });
                
                // Update DOM
                document.getElementById('pie-chart-container').innerHTML = '';
                document.getElementById('pie-chart-container').appendChild(svg);
                document.getElementById('chart-legend').innerHTML = legendHTML;
            },
            
            createPieSlice(centerX, centerY, radius, startAngle, endAngle, color) {
                const startAngleRad = (startAngle * Math.PI) / 180;
                const endAngleRad = (endAngle * Math.PI) / 180;
                
                const x1 = centerX + radius * Math.cos(startAngleRad);
                const y1 = centerY + radius * Math.sin(startAngleRad);
                const x2 = centerX + radius * Math.cos(endAngleRad);
                const y2 = centerY + radius * Math.sin(endAngleRad);
                
                const largeArcFlag = endAngle - startAngle > 180 ? 1 : 0;
                
                const pathData = `M ${centerX} ${centerY} L ${x1} ${y1} A ${radius} ${radius} 0 ${largeArcFlag} 1 ${x2} ${y2} Z`;
                
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('d', pathData);
                path.setAttribute('fill', color);
                path.setAttribute('class', 'pie-slice');
                path.setAttribute('stroke', 'white');
                path.setAttribute('stroke-width', '2');
                
                // Add hover effect with title
                const percentage = ((endAngle - startAngle) / 360 * 100).toFixed(1);
                path.setAttribute('title', `${percentage}%`);
                
                return path;
            },
            
            renderAllTasks() {
                // Clear all quadrants
                ['1', '2', '3', '4', 'held'].forEach(quadrant => {
                    document.getElementById(`quadrant-${quadrant}-items`).innerHTML = '';
                });
                
                // Sort tasks by GRACE score (highest first) and render
                const sortedTasks = [...this.tasks].sort((a, b) => {
                    if (a.completed !== b.completed) {
                        return a.completed ? 1 : -1; // Completed tasks go to bottom
                    }
                    return b.graceScore - a.graceScore; // Higher GRACE scores first
                });
                
                sortedTasks.forEach(task => {
                    this.renderTask(task);
                });
            },
            
            renderTask(task) {
                const quadrantId = `quadrant-${task.quadrant}-items`;
                const container = document.getElementById(quadrantId);
                
                const itemDiv = document.createElement('div');
                itemDiv.className = `item ${task.completed ? 'completed' : ''}`;
                itemDiv.dataset.taskId = task.id;
                itemDiv.onclick = () => openEditModal(task.id);
                
                // Simplified display - single line format: Title - Icon - Duration - Recurrence - GRACE Score
                itemDiv.innerHTML = `
                    <div class="item-controls">
                        <button class="control-btn" onclick="event.stopPropagation(); taskStorage.toggleComplete(${task.id})" title="Toggle Complete">
                            ${task.completed ? '✓' : '○'}
                        </button>
                        <button class="control-btn" onclick="event.stopPropagation(); deleteTask(${task.id})" title="Delete">
                            ×
                        </button>
                    </div>
                    <div class="item-title">${task.title} - ${getTaskTypeIcon(task.taskType)} - ${task.estimatedTime}h - ${task.recurrence} - ${task.graceScore}</div>
                    ${task.quadrant === 2 && task.resources === 'Yes' && !task.completed ? 
                        `<a href="${generateCalendarURL(task)}" target="_blank" class="calendar-link" onclick="event.stopPropagation()">
                            📅 Schedule
                        </a>` : ''
                    }
                `;
                
                container.appendChild(itemDiv);
            }
        };
        
        function getTaskTypeIcon(taskType) {
            const icons = {
                'Church': '⛪',
                'Family': '👨‍👩‍👧‍👦',
                'Work': '💼',
                'Relationships': '🤝',
                'Self': '🧘'
            };
            return icons[taskType] || '📋';
        }
        
        let currentEditingId = null;
        
        function openEditModal(taskId) {
            const task = taskStorage.tasks.find(t => t.id === taskId);
            if (!task) return;
            
            currentEditingId = taskId;
            
            // Populate modal fields
            document.getElementById('edit-title').value = task.title;
            document.getElementById('edit-description').value = task.description || '';
            document.getElementById('edit-task-type').value = task.taskType;
            document.getElementById('edit-estimated-time').value = task.estimatedTime;
            document.getElementById('edit-manual-grace-score').value = task.manualGraceScore || '';
            document.getElementById('edit-recurrence').value = task.recurrence;
            document.getElementById('edit-resources').value = task.resources;
            document.getElementById('edit-urgency').value = task.urgency;
            document.getElementById('edit-importance').value = task.importance;
            
            document.getElementById('editModal').style.display = 'block';
        }
        
        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
            currentEditingId = null;
        }
        
        function saveEdit() {
            if (!currentEditingId) return;
            
            const updates = {
                title: document.getElementById('edit-title').value,
                description: document.getElementById('edit-description').value,
                taskType: document.getElementById('edit-task-type').value,
                estimatedTime: document.getElementById('edit-estimated-time').value,
                recurrence: document.getElementById('edit-recurrence').value,
                resources: document.getElementById('edit-resources').value,
                urgency: document.getElementById('edit-urgency').value,
                importance: document.getElementById('edit-importance').value
            };
            
            const manualGraceScore = document.getElementById('edit-manual-grace-score').value;
            const manualScore = manualGraceScore ? parseInt(manualGraceScore) : null;
            
            if (!updates.title || !updates.taskType || !updates.estimatedTime || 
                !updates.recurrence || !updates.resources || !updates.urgency || !updates.importance) {
                alert('Please fill in all required fields');
                return;
            }
            
            // Validate manual GRACE score if provided
            if (manualScore !== null && (manualScore < 0 || manualScore > 100)) {
                alert('Manual GRACE score must be between 0 and 100');
                document.getElementById('edit-manual-grace-score').focus();
                return;
            }
            
            // Recalculate quadrant and GRACE score
            updates.quadrant = determineQuadrant(updates.urgency, updates.importance, updates.resources);
            updates.graceScore = calculateGraceScore(updates.title, updates.description || '', updates.taskType, manualScore, updates.estimatedTime, updates.recurrence);
            updates.manualGraceScore = manualScore;
            
            taskStorage.updateTask(currentEditingId, updates);
            closeEditModal();
            
            // Show success message
            showNotification('✅ Task updated successfully!', 'success');
        }
        
        function deleteTask(taskId) {
            if (confirm('Are you sure you want to delete this task?')) {
                taskStorage.deleteTask(taskId);
            }
        }
        
        function addItem() {
            const title = document.getElementById('item-title').value.trim();
            const description = document.getElementById('item-description').value.trim();
            const taskType = document.getElementById('task-type').value;
            const estimatedTime = document.getElementById('estimated-time').value;
            const manualGraceScore = document.getElementById('manual-grace-score').value;
            const recurrence = document.getElementById('recurrence').value;
            const resources = document.getElementById('resources').value;
            const urgency = document.getElementById('urgency').value;
            const importance = document.getElementById('importance').value;
            
            // Validate required fields
            if (!title) {
                alert('Please enter a task title');
                document.getElementById('item-title').focus();
                return;
            }
            
            if (!taskType) {
                alert('Please select a task type');
                document.getElementById('task-type').focus();
                return;
            }
            
            if (!estimatedTime || estimatedTime <= 0) {
                alert('Please enter estimated hours (must be greater than 0)');
                document.getElementById('estimated-time').focus();
                return;
            }
            
            if (!recurrence) {
                alert('Please select recurrence');
                document.getElementById('recurrence').focus();
                return;
            }
            
            if (!resources) {
                alert('Please specify if resources are available');
                document.getElementById('resources').focus();
                return;
            }
            
            if (!urgency) {
                alert('Please select urgency level');
                document.getElementById('urgency').focus();
                return;
            }
            
            if (!importance) {
                alert('Please select importance level');
                document.getElementById('importance').focus();
                return;
            }
            
            // Validate manual GRACE score if provided
            const manualScore = manualGraceScore ? parseInt(manualGraceScore) : null;
            if (manualScore !== null && (manualScore < 0 || manualScore > 100)) {
                alert('Manual GRACE score must be between 0 and 100');
                document.getElementById('manual-grace-score').focus();
                return;
            }
            
            const task = {
                title,
                description,
                taskType,
                estimatedTime: parseFloat(estimatedTime),
                recurrence,
                resources,
                urgency,
                importance,
                quadrant: determineQuadrant(urgency, importance, resources),
                graceScore: calculateGraceScore(title, description, taskType, manualScore, estimatedTime, recurrence),
                manualGraceScore: manualScore
            };
            
            taskStorage.addTask(task);
            clearForm();
            
            // Show success message with GRACE score explanation
            const autoScore = calculateGraceScore(title, description, taskType, null, estimatedTime, recurrence);
            const finalScore = task.graceScore;
            let message = `✅ Task added successfully! GRACE Score: ${finalScore}/100`;
            
            if (manualScore !== null) {
                message += ` (Manual Override: ${manualScore}, Auto: ${autoScore})`;
            } else if (taskType === 'Self' && ['sleep', 'rest', 'exercise', 'workout', 'health'].some(keyword => title.toLowerCase().includes(keyword))) {
                message += ` (Self-care foundation recognized!)`;
            }
            
            showNotification(message, 'success');
        }
        
        function determineQuadrant(urgency, importance, resources) {
            if (resources === 'No') {
                return 'held';
            }
            
            if (urgency === 'high' && importance === 'high') return 1;
            if (urgency === 'low' && importance === 'high') return 2;
            if (urgency === 'high' && importance === 'low') return 3;
            return 4;
        }
        
        function clearForm() {
            document.getElementById('item-title').value = '';
            document.getElementById('item-description').value = '';
            document.getElementById('task-type').value = '';
            document.getElementById('estimated-time').value = '';
            document.getElementById('manual-grace-score').value = '';
            document.getElementById('recurrence').value = '';
            document.getElementById('resources').value = '';
            document.getElementById('urgency').value = '';
            document.getElementById('importance').value = '';
        }
        
        // Enhanced GRACE scoring algorithm with comprehensive context analysis
        function calculateGraceScore(title, description, taskType, manualOverride = null, estimatedTime = 0, recurrence = '') {
            // If manual override is provided, use it
            if (manualOverride !== null && manualOverride >= 0 && manualOverride <= 100) {
                return manualOverride;
            }
            
            const text = (title + ' ' + (description || '')).toLowerCase();
            const hours = parseFloat(estimatedTime) || 0;
            const recurType = (recurrence || '').toLowerCase();
            let totalScore = 0;
            const breakdown = { G: 0, R: 0, A: 0, C: 0, E: 0 };
            
            // Context multipliers based on recurrence (daily habits are more impactful)
            const recurrenceMultiplier = {
                'daily': 1.3,
                'weekly': 1.2,
                'monthly': 1.1,
                'annually': 1.0,
                'non-recurring': 1.0
            };
            const recurMult = recurrenceMultiplier[recurType] || 1.0;
            
            // Duration significance (longer commitments show more intentionality)
            const durationBonus = Math.min(hours * 0.5, 5); // Up to 5 bonus points for long tasks
            
            // GLORIFY GOD (0-20 points) - Christian World View, Lutheran Missouri Synod
            let glorifyScore = 0;
            
            // Direct Christian/Lutheran themes (15-20 points)
            const directFaithKeywords = ['god', 'jesus', 'christ', 'holy spirit', 'trinity', 'scripture', 'bible', 'prayer', 'worship', 'communion', 'baptism', 'church', 'ministry', 'pastor', 'sermon', 'devotion', 'confession', 'forgiveness'];
            const lutheranKeywords = ['lutheran', 'lcms', 'missouri synod', 'catechism', 'confirmation', 'liturgy', 'sacrament'];
            
            if (directFaithKeywords.some(keyword => text.includes(keyword)) || taskType === 'Church') {
                glorifyScore += lutheranKeywords.some(keyword => text.includes(keyword)) ? 20 : 18;
                // Daily devotions get bonus
                if (recurType === 'daily' && (text.includes('devotion') || text.includes('prayer') || text.includes('bible'))) {
                    glorifyScore += 2;
                }
            }
            // Christian worldview in work/life (10-15 points)
            else if (text.includes('integrity') || text.includes('honesty') || text.includes('stewardship') || text.includes('calling') || text.includes('vocation')) {
                glorifyScore += 12;
            }
            // Self-care as temple care (8-12 points)
            else if (taskType === 'Self' && ['sleep', 'rest', 'health', 'exercise', 'nutrition'].some(keyword => text.includes(keyword))) {
                glorifyScore += 10;
                // Long sleep (7+ hours) or daily exercise shows stewardship
                if ((text.includes('sleep') && hours >= 7) || (text.includes('exercise') && recurType === 'daily')) {
                    glorifyScore += 3;
                }
                // Adequate sleep duration bonus
                if (text.includes('sleep') && hours >= 8) {
                    glorifyScore += 2; // Optimal stewardship of body
                }
            }
            // Family as God-given responsibility (6-10 points)
            else if (taskType === 'Family' && (text.includes('raise') || text.includes('teach') || text.includes('guide') || text.includes('love'))) {
                glorifyScore += 8;
                // Regular family time shows commitment
                if (recurType === 'daily' || recurType === 'weekly') {
                    glorifyScore += 3;
                }
            }
            // Ethical work practices (4-8 points)
            else if (taskType === 'Work' && (text.includes('ethical') || text.includes('honest') || text.includes('fair') || text.includes('quality'))) {
                glorifyScore += 6;
            }
            
            breakdown.G = Math.min(Math.round(glorifyScore * recurMult), 25); // Allow bonus up to 25
            totalScore += breakdown.G;
            
            // RAISE UP TEAMS (0-20 points) - Servant Leadership, Build Trust, Empower Others
            let raiseScore = 0;
            
            // Direct leadership and mentoring (15-20 points)
            const leadershipKeywords = ['lead', 'leadership', 'mentor', 'coach', 'guide', 'teach', 'train', 'develop', 'empower', 'inspire', 'motivate', 'delegate'];
            const servantLeaderKeywords = ['servant leadership', 'serve team', 'support team', 'enable', 'facilitate', 'humble'];
            const trustKeywords = ['trust', 'transparency', 'honest', 'reliable', 'dependable', 'integrity', 'credibility'];
            
            if (servantLeaderKeywords.some(keyword => text.includes(keyword))) {
                raiseScore += 20;
            } else if (leadershipKeywords.some(keyword => text.includes(keyword)) && trustKeywords.some(keyword => text.includes(keyword))) {
                raiseScore += 18;
            } else if (leadershipKeywords.some(keyword => text.includes(keyword))) {
                raiseScore += 15;
                // Regular 1:1s or team meetings show consistent leadership
                if ((text.includes('1:1') || text.includes('meeting')) && (recurType === 'weekly' || recurType === 'monthly')) {
                    raiseScore += 4;
                }
            }
            // Team collaboration and support (10-15 points)
            else if (text.includes('team') || text.includes('collaborate') || text.includes('meeting') || text.includes('1:1') || text.includes('feedback')) {
                raiseScore += 12;
                // Long meetings show deep investment
                if (hours >= 1 && text.includes('meeting')) {
                    raiseScore += 2;
                }
            }
            // Relationship building (8-12 points)
            else if (taskType === 'Relationships' || (taskType === 'Work' && (text.includes('relationship') || text.includes('network')))) {
                raiseScore += 10;
                // Regular relationship investment
                if (recurType === 'weekly' || recurType === 'monthly') {
                    raiseScore += 3;
                }
            }
            // Family leadership (6-10 points)
            else if (taskType === 'Family' && (text.includes('teach') || text.includes('guide') || text.includes('model'))) {
                raiseScore += 8;
            }
            // Personal development for leadership (4-8 points)
            else if (taskType === 'Self' && (text.includes('leadership') || text.includes('communication') || text.includes('skill'))) {
                raiseScore += 6;
            }
            // Self-care enables leadership (recognized with sleep duration)
            else if (taskType === 'Self' && text.includes('sleep')) {
                if (hours >= 7) {
                    raiseScore += 6; // Well-rested leaders are better leaders
                    if (hours >= 8) {
                        raiseScore += 2; // Optimal rest for leadership
                    }
                }
            }
            
            breakdown.R = Math.min(Math.round(raiseScore * recurMult), 25);
            totalScore += breakdown.R;
            
            // ARCHITECT SYSTEMS (0-20 points) - Organizing, Efficiency, Automation
            let architectScore = 0;
            
            // System design and architecture (15-20 points)
            const systemKeywords = ['system', 'architecture', 'framework', 'infrastructure', 'platform', 'design', 'structure'];
            const efficiencyKeywords = ['efficiency', 'optimize', 'streamline', 'automate', 'process', 'workflow', 'lean'];
            const organizingKeywords = ['organize', 'structure', 'plan', 'schedule', 'coordinate', 'manage', 'systematic'];
            
            if (systemKeywords.some(keyword => text.includes(keyword)) && efficiencyKeywords.some(keyword => text.includes(keyword))) {
                architectScore += 20;
                // Complex systems take more time
                if (hours >= 4) {
                    architectScore += 3;
                }
            } else if (systemKeywords.some(keyword => text.includes(keyword))) {
                architectScore += 17;
            } else if (efficiencyKeywords.some(keyword => text.includes(keyword))) {
                architectScore += 15;
            }
            // Organizing and planning (10-15 points)
            else if (organizingKeywords.some(keyword => text.includes(keyword))) {
                architectScore += 12;
                // Regular planning sessions
                if ((text.includes('plan') || text.includes('organize')) && (recurType === 'weekly' || recurType === 'daily')) {
                    architectScore += 3;
                }
            }
            // Work process improvement (8-12 points)
            else if (taskType === 'Work' && (text.includes('improve') || text.includes('process') || text.includes('method'))) {
                architectScore += 10;
            }
            // Personal organization systems (6-10 points)
            else if (taskType === 'Self' && (text.includes('routine') || text.includes('habit') || text.includes('organize'))) {
                architectScore += 8;
                // Daily routines are systematic
                if (recurType === 'daily') {
                    architectScore += 4;
                }
            }
            // Sleep routine as system architecture
            else if (taskType === 'Self' && text.includes('sleep')) {
                if (hours >= 7 && (recurType === 'daily' || text.includes('routine'))) {
                    architectScore += 8; // Consistent sleep schedule is good systems thinking
                }
            }
            // Family systems and routines (4-8 points)
            else if (taskType === 'Family' && (text.includes('routine') || text.includes('schedule') || text.includes('organize'))) {
                architectScore += 6;
            }
            
            breakdown.A = Math.min(Math.round(architectScore * recurMult + durationBonus * 0.3), 25);
            totalScore += breakdown.A;
            
            // CREATE SOLUTIONS (0-20 points) - Creativity, Learning, Independent Achievement, Engineering Excellence
            let createScore = 0;
            
            // Engineering and technical excellence (15-20 points)
            const engineeringKeywords = ['engineer', 'design', 'build', 'develop', 'code', 'software', 'technical', 'architecture', 'solution'];
            const creativityKeywords = ['creative', 'innovate', 'invent', 'design', 'brainstorm', 'ideate', 'original'];
            const learningKeywords = ['learn', 'study', 'research', 'explore', 'discover', 'understand', 'master'];
            const achievementKeywords = ['achieve', 'accomplish', 'complete', 'deliver', 'execute', 'implement'];
            
            if (engineeringKeywords.some(keyword => text.includes(keyword)) && (creativityKeywords.some(keyword => text.includes(keyword)) || achievementKeywords.some(keyword => text.includes(keyword)))) {
                createScore += 20;
                // Complex engineering projects
                if (hours >= 8) {
                    createScore += 4;
                }
            } else if (engineeringKeywords.some(keyword => text.includes(keyword))) {
                createScore += 17;
            } else if (creativityKeywords.some(keyword => text.includes(keyword)) && learningKeywords.some(keyword => text.includes(keyword))) {
                createScore += 15;
            }
            // Problem solving and innovation (10-15 points)
            else if (text.includes('solve') || text.includes('fix') || text.includes('resolve') || text.includes('troubleshoot')) {
                createScore += 12;
            }
            // Learning and skill development (8-12 points)
            else if (learningKeywords.some(keyword => text.includes(keyword)) || (taskType === 'Self' && text.includes('skill'))) {
                createScore += 10;
                // Consistent learning
                if (recurType === 'daily' || recurType === 'weekly') {
                    createScore += 3;
                }
                // Deep learning sessions
                if (hours >= 2) {
                    createScore += 2;
                }
            }
            // Work projects and delivery (6-10 points)
            else if (taskType === 'Work' && (text.includes('project') || text.includes('deliver') || text.includes('create'))) {
                createScore += 8;
            }
            // Personal creative pursuits (4-8 points)
            else if (taskType === 'Self' && (text.includes('hobby') || text.includes('art') || text.includes('music') || text.includes('write'))) {
                createScore += 6;
            }
            
            breakdown.C = Math.min(Math.round(createScore * recurMult + durationBonus * 0.4), 25);
            totalScore += breakdown.C;
            
            // ENRICH OTHERS (0-20 points) - Help Others, Serve Others, Support Others
            let enrichScore = 0;
            
            // Direct service and helping (15-20 points)
            const serviceKeywords = ['serve', 'service', 'volunteer', 'help', 'assist', 'support', 'care', 'give'];
            const enrichKeywords = ['enrich', 'benefit', 'improve', 'enhance', 'contribute', 'add value', 'make better'];
            const supportKeywords = ['support', 'encourage', 'comfort', 'listen', 'counsel', 'guide', 'advise'];
            
            if (serviceKeywords.some(keyword => text.includes(keyword)) && enrichKeywords.some(keyword => text.includes(keyword))) {
                enrichScore += 20;
                // Long service commitments
                if (hours >= 3) {
                    enrichScore += 3;
                }
            } else if (serviceKeywords.some(keyword => text.includes(keyword))) {
                enrichScore += 17;
            } else if (supportKeywords.some(keyword => text.includes(keyword))) {
                enrichScore += 15;
            }
            // Family care and love (12-16 points)
            else if (taskType === 'Family') {
                enrichScore += 14;
                // Quality time with family
                if (hours >= 2) {
                    enrichScore += 2;
                }
                // Regular family investment
                if (recurType === 'daily' || recurType === 'weekly') {
                    enrichScore += 3;
                }
            }
            // Church and ministry service (12-16 points)
            else if (taskType === 'Church') {
                enrichScore += 14;
                // Regular ministry commitment
                if (recurType === 'weekly' || recurType === 'monthly') {
                    enrichScore += 3;
                }
            }
            // Relationship investment (10-14 points)
            else if (taskType === 'Relationships') {
                enrichScore += 12;
                // Quality time in relationships
                if (hours >= 1) {
                    enrichScore += 2;
                }
            }
            // Work that serves customers/users (8-12 points)
            else if (taskType === 'Work' && (text.includes('customer') || text.includes('user') || text.includes('client'))) {
                enrichScore += 10;
            }
            // Self-care that enables service (6-10 points)
            else if (taskType === 'Self' && ['sleep', 'rest', 'health', 'exercise', 'recharge'].some(keyword => text.includes(keyword))) {
                enrichScore += 8;
                // Adequate sleep enables better service
                if (text.includes('sleep') && hours >= 7) {
                    enrichScore += 4; // Well-rested people serve better
                    if (hours >= 8) {
                        enrichScore += 2; // Optimal rest for service
                    }
                }
                // Regular exercise enables sustained service
                if (text.includes('exercise') && recurType === 'daily') {
                    enrichScore += 3;
                }
            }
            
            breakdown.E = Math.min(Math.round(enrichScore * recurMult), 25);
            totalScore += breakdown.E;
            
            // Store breakdown for display
            this.lastGraceBreakdown = breakdown;
            
            return Math.min(totalScore, 100);
        }
        
        function generateCalendarURL(task) {
            const baseURL = 'https://calendar.google.com/calendar/render?action=TEMPLATE';
            const eventTitle = encodeURIComponent(`${getTaskTypeIcon(task.taskType)} ${task.title}`);
            const startDate = getNextWeekday();
            const endDate = getNextWeekday(task.estimatedTime * 60);
            
            const description = encodeURIComponent(
                `GRACE Framework Priority (Score: ${task.graceScore}/5)\n` +
                `${task.description ? task.description + '\n\n' : ''}` +
                `Task Type: ${task.taskType}\n` +
                `Estimated Time: ${task.estimatedTime} hours\n` +
                `Recurrence: ${task.recurrence}\n\n` +
                `Priority Level: Important but Not Urgent\n` +
                `Action: Schedule dedicated time for this priority`
            );
            
            return `${baseURL}&text=${eventTitle}&dates=${startDate}/${endDate}&details=${description}&recur=${getRecurrenceRule(task.recurrence)}`;
        }
        
        function getRecurrenceRule(recurrence) {
            switch(recurrence) {
                case 'Daily': return 'RRULE:FREQ=DAILY';
                case 'Weekly': return 'RRULE:FREQ=WEEKLY';
                case 'Monthly': return 'RRULE:FREQ=MONTHLY';
                case 'Annually': return 'RRULE:FREQ=YEARLY';
                default: return '';
            }
        }
        
        function getNextWeekday(offsetMinutes = 0) {
            const now = new Date();
            const tomorrow = new Date(now);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            if (tomorrow.getDay() === 0) tomorrow.setDate(tomorrow.getDate() + 1);
            else if (tomorrow.getDay() === 6) tomorrow.setDate(tomorrow.getDate() + 2);
            
            tomorrow.setHours(9, 0, 0, 0);
            if (offsetMinutes > 0) tomorrow.setMinutes(tomorrow.getMinutes() + offsetMinutes);
            
            return tomorrow.toISOString().replace(/[-:]/g, '').replace(/\.\d{3}/, '');
        }
        
        function exportData() {
            const data = {
                tasks: taskStorage.tasks,
                exportDate: new Date().toISOString(),
                version: '2.0',
                metadata: {
                    totalTasks: taskStorage.tasks.length,
                    completedTasks: taskStorage.tasks.filter(t => t.completed).length,
                    totalHours: taskStorage.tasks.reduce((sum, t) => sum + (parseFloat(t.estimatedTime) || 0), 0),
                    avgGraceScore: taskStorage.tasks.length > 0 
                        ? (taskStorage.tasks.reduce((sum, t) => sum + t.graceScore, 0) / taskStorage.tasks.length).toFixed(1)
                        : 0.0,
                    categoryBreakdown: getCategoryBreakdown()
                }
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `grace-matrix-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // Show success message
            showNotification('✅ Data exported successfully!', 'success');
        }
        
        function getCategoryBreakdown() {
            const breakdown = { Church: 0, Family: 0, Work: 0, Relationships: 0, Self: 0 };
            taskStorage.tasks.forEach(task => {
                if (breakdown.hasOwnProperty(task.taskType)) {
                    breakdown[task.taskType] += parseFloat(task.estimatedTime) || 0;
                }
            });
            return breakdown;
        }
        
        function importData() {
            document.getElementById('import-file').click();
        }
        
        function exportToCSV() {
            const headers = [
                'Title', 'Description', 'Task Type', 'Estimated Hours', 'Recurrence', 
                'Resources Available', 'Urgency', 'Importance', 'Quadrant', 'GRACE Score', 
                'Completed', 'Created Date', 'Completed Date'
            ];
            
            const csvData = taskStorage.tasks.map(task => [
                `"${task.title.replace(/"/g, '""')}"`,
                `"${(task.description || '').replace(/"/g, '""')}"`,
                task.taskType,
                task.estimatedTime,
                task.recurrence,
                task.resources,
                task.urgency,
                task.importance,
                task.quadrant,
                task.graceScore,
                task.completed ? 'Yes' : 'No',
                new Date(task.createdAt).toLocaleDateString(),
                task.completedAt ? new Date(task.completedAt).toLocaleDateString() : ''
            ].join(','));
            
            const csvContent = [headers.join(','), ...csvData].join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `grace-matrix-${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('📊 CSV exported successfully!', 'success');
        }
        
        function importFromCSV(csvText) {
            const lines = csvText.split('\n');
            const headers = lines[0].split(',');
            
            if (!headers.includes('Title') || !headers.includes('Task Type')) {
                throw new Error('Invalid CSV format. Required columns: Title, Task Type');
            }
            
            const tasks = [];
            
            for (let i = 1; i < lines.length; i++) {
                if (lines[i].trim() === '') continue;
                
                const values = parseCSVLine(lines[i]);
                if (values.length < headers.length) continue;
                
                const task = {};
                headers.forEach((header, index) => {
                    const cleanHeader = header.trim().replace(/"/g, '');
                    const value = values[index] ? values[index].replace(/"/g, '') : '';
                    
                    switch (cleanHeader) {
                        case 'Title':
                            task.title = value;
                            break;
                        case 'Description':
                            task.description = value;
                            break;
                        case 'Task Type':
                            task.taskType = value;
                            break;
                        case 'Estimated Hours':
                            task.estimatedTime = parseFloat(value) || 1;
                            break;
                        case 'Recurrence':
                            task.recurrence = value || 'Non-recurring';
                            break;
                        case 'Resources Available':
                            task.resources = value || 'Yes';
                            break;
                        case 'Urgency':
                            task.urgency = value || 'low';
                            break;
                        case 'Importance':
                            task.importance = value || 'low';
                            break;
                        case 'Completed':
                            task.completed = value.toLowerCase() === 'yes';
                            break;
                    }
                });
                
                if (task.title && task.taskType) {
                    task.quadrant = determineQuadrant(task.urgency, task.importance, task.resources);
                    task.graceScore = calculateGraceScore(task.title, task.description || '', task.taskType);
                    task.createdAt = new Date().toISOString();
                    task.completedAt = task.completed ? new Date().toISOString() : null;
                    tasks.push(task);
                }
            }
            
            return tasks;
        }
        
        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"') {
                    if (inQuotes && line[i + 1] === '"') {
                        current += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current);
            return result;
        }
        
        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 10px;
                color: white;
                font-weight: 600;
                z-index: 1001;
                transform: translateX(100%);
                transition: transform 0.3s ease;
                box-shadow: 0 10px 20px rgba(0,0,0,0.2);
                ${type === 'success' ? 'background: linear-gradient(135deg, #28a745, #20c997);' : 
                  type === 'error' ? 'background: linear-gradient(135deg, #dc3545, #fd7e14);' : 
                  'background: linear-gradient(135deg, #667eea, #764ba2);'}
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // Animate out and remove
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
        
        function clearCompleted() {
            if (confirm('Are you sure you want to remove all completed tasks?')) {
                taskStorage.tasks = taskStorage.tasks.filter(task => !task.completed);
                taskStorage.save();
                showNotification('🗑️ Completed tasks cleared!', 'success');
            }
        }
        
        // Event listeners
        document.getElementById('import-file').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const content = e.target.result;
                    let importedTasks = [];
                    
                    if (file.name.endsWith('.json')) {
                        // Handle JSON import
                        const data = JSON.parse(content);
                        if (data.tasks && Array.isArray(data.tasks)) {
                            importedTasks = data.tasks;
                        } else {
                            throw new Error('Invalid JSON format. Expected tasks array.');
                        }
                    } else if (file.name.endsWith('.csv')) {
                        // Handle CSV import
                        importedTasks = importFromCSV(content);
                    } else {
                        throw new Error('Unsupported file format. Please use JSON or CSV files.');
                    }
                    
                    if (importedTasks.length === 0) {
                        showNotification('⚠️ No valid tasks found in the file', 'error');
                        return;
                    }
                    
                    const action = confirm(
                        `Found ${importedTasks.length} tasks to import.\n\n` +
                        `Choose OK to REPLACE all current tasks, or Cancel to MERGE with existing tasks.`
                    );
                    
                    if (action === true) {
                        // Replace all tasks
                        taskStorage.tasks = importedTasks.map(task => ({
                            ...task,
                            id: taskStorage.nextId++
                        }));
                        showNotification(`✅ Replaced with ${importedTasks.length} tasks!`, 'success');
                    } else if (action === false) {
                        // Merge tasks
                        importedTasks.forEach(task => {
                            task.id = taskStorage.nextId++;
                            taskStorage.tasks.push(task);
                        });
                        showNotification(`✅ Added ${importedTasks.length} new tasks!`, 'success');
                    } else {
                        showNotification('❌ Import cancelled', 'info');
                        return;
                    }
                    
                    taskStorage.save();
                    
                } catch (error) {
                    showNotification('❌ Import failed: ' + error.message, 'error');
                    console.error('Import error:', error);
                }
            };
            
            reader.readAsText(file);
            this.value = '';
        });
        
        // Modal event listeners
        document.querySelector('.close').onclick = closeEditModal;
        window.onclick = function(event) {
            const modal = document.getElementById('editModal');
            if (event.target === modal) {
                closeEditModal();
            }
        };
        
        // Enter key support
        document.getElementById('item-title').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') addItem();
        });
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            taskStorage.load();
        });
    </script>
</body>
</html><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GRACE-Eisenhower Priority Matrix</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            padding: 40px;
            position: relative;
            overflow: hidden;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }
        
        .header h1 {
            color: #2c3e50;
            margin: 0 0 15px 0;
            font-size: 2.2em;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .grace-subtitle {
            color: #7f8c8d;
            font-size: 1em;
            margin-bottom: 20px;
            font-weight: 600;
        }
        
        .grace-framework {
            color: #2c3e50;
            padding: 20px;
            margin-bottom: 40px;
            text-align: center;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            border: 1px solid #dee2e6;
        }
        
        .grace-items {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .grace-item {
            padding: 12px 15px;
            font-size: 1em;
            font-weight: 600;
            color: #2c3e50;
            background: rgba(255,255,255,0.8);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .grace-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }
        
        .time-allocation-chart {
            background: rgba(255,255,255,0.9);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .chart-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        
        .pie-chart {
            width: 300px;
            height: 300px;
            margin: 0 auto 20px;
            position: relative;
        }
        
        .pie-chart svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }
        
        .pie-slice {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .pie-slice:hover {
            opacity: 0.8;
            transform: scale(1.05);
            transform-origin: center;
        }
        
        .chart-legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .legend-entry {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            background: rgba(255,255,255,0.7);
            border-radius: 8px;
            font-size: 0.9em;
            transition: all 0.2s ease;
        }
        
        .legend-entry:hover {
            background: rgba(255,255,255,0.9);
            transform: translateY(-1px);
        }
        
        .legend-color-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }
        
        .legend-text {
            font-weight: 500;
            color: #2c3e50;
        }
        
        .no-data-message {
            color: #6c757d;
            font-style: italic;
            padding: 40px;
            background: rgba(255,255,255,0.5);
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .stat-item {
            text-align: center;
            padding: 10px;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            display: block;
        }
        
        .stat-label {
            color: #6c757d;
            font-size: 0.9em;
            font-weight: 500;
        }
        
        .matrix-container {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: auto auto;
            gap: 20px;
            min-height: 550px;
            margin-bottom: 40px;
            border: 3px solid #2c3e50;
            border-radius: 15px;
            overflow: visible;
            position: relative;
        }
        
        .quadrant {
            padding: 25px;
            border: 2px solid #ecf0f1;
            position: relative;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: visible;
            min-height: 200px;
            display: flex;
            flex-direction: column;
        }
        
        .quadrant:hover {
            transform: scale(1.01);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
            z-index: 1;
        }
        
        .quadrant-held {
            background: linear-gradient(135deg, #e9ecef, #ced4da);
            color: #495057;
            grid-row: 1 / 3;
            position: relative;
            min-height: 450px;
        }
        
        .quadrant-1 {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }
        
        .quadrant-2 {
            background: linear-gradient(135deg, #ffc107, #fd7e14);
            color: white;
        }
        
        .quadrant-3 {
            background: linear-gradient(135deg, #6f42c1, #e83e8c);
            color: white;
        }
        
        .quadrant-4 {
            background: linear-gradient(135deg, #dc3545, #fd7e14);
            color: white;
        }
        
        .quadrant-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 12px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .quadrant-count {
            background: rgba(255,255,255,0.3);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: normal;
        }
        
        .quadrant-subtitle {
            font-size: 1em;
            opacity: 0.9;
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .items-list {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
            overflow: visible;
        }
        
        .item {
            background: rgba(255,255,255,0.15);
            padding: 10px 15px;
            margin: 6px 0;
            border-radius: 10px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.2);
            animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
            min-height: 40px;
            display: flex;
            align-items: center;
        }
        
        .item:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }
        
        .item.completed {
            opacity: 0.6;
            background: rgba(255,255,255,0.1);
        }
        
        .item.completed .item-title {
            text-decoration: line-through;
        }
        
        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(20px) scale(0.95); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }
        
        .item-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .item:hover .item-controls {
            opacity: 1;
        }
        
        .control-btn {
            background: rgba(255,255,255,0.3);
            border: none;
            padding: 4px 6px;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            font-size: 0.75em;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
        }
        
        .control-btn:hover {
            background: rgba(255,255,255,0.5);
            transform: scale(1.1);
        }
        
        .calendar-link {
            display: inline-block;
            background: rgba(255,255,255,0.3);
            padding: 6px 12px;
            border-radius: 15px;
            text-decoration: none;
            color: white;
            font-size: 0.8em;
            margin-top: 8px;
            border: 1px solid rgba(255,255,255,0.4);
            transition: all 0.3s ease;
        }
        
        .calendar-link:hover {
            background: rgba(255,255,255,0.5);
            transform: translateY(-1px);
        }
        
        .item-title {
            font-weight: 600;
            font-size: 0.95em;
            color: inherit;
            margin: 0;
            padding-right: 70px;
            line-height: 1.4;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .item-priority {
            font-size: 0.75em;
            opacity: 0.8;
            margin-top: 4px;
            font-weight: 500;
        }
        
        .grace-indicator {
            display: inline-block;
            background: rgba(255,255,255,0.3);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.7em;
            font-weight: bold;
            margin-top: 4px;
        }
        
        .input-section {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }
        
        .input-section h3 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        
        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        input[type="text"], input[type="number"], select, textarea {
            padding: 15px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }
        
        input[type="text"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }
        
        textarea {
            resize: vertical;
            min-height: 80px;
            grid-column: 1 / -1;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        button:hover::before {
            left: 100%;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }
        
        .secondary-btn {
            background: linear-gradient(135deg, #6c757d, #495057);
        }
        
        .secondary-btn:hover {
            box-shadow: 0 15px 30px rgba(108, 117, 125, 0.4);
        }
        
        .legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            background: rgba(255,255,255,0.5);
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .legend-item:hover {
            background: rgba(255,255,255,0.8);
            transform: translateY(-2px);
        }
        
        .legend-color {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            flex-shrink: 0;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        
        .close:hover {
            color: #667eea;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        @media (max-width: 768px) {
            .matrix-container {
                grid-template-columns: 1fr;
                grid-template-rows: repeat(5, auto);
                min-height: auto;
            }
            
            .quadrant-held {
                grid-row: auto;
                min-height: 200px;
            }
            
            .input-group {
                grid-template-columns: 1fr;
            }
            
            .grace-items {
                flex-direction: column;
                align-items: center;
            }
            
            .pie-chart {
                width: 250px;
                height: 250px;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .quadrant {
                padding: 15px;
            }
            
            .stats-bar {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Brian's Values-Driven Prioritization</h1>
            <div class="grace-subtitle" style="font-size: 1.1em; font-weight: bold; color: #2c3e50;">My Why - G.R.A.C.E</div>
            <div class="grace-framework">
                <div class="grace-items">
                    <div class="grace-item">🙏 Glorify God</div>
                    <div class="grace-item">👥 Raise Up Teams</div>
                    <div class="grace-item">🏗️ Architect Systems</div>
                    <div class="grace-item">💡 Create Solutions</div>
                    <div class="grace-item">🌟 Enrich Others</div>
                </div>
            </div>
        </div>
        
        <div class="stats-bar">
            <div class="stat-item">
                <span class="stat-number" id="total-tasks">0</span>
                <span class="stat-label">Total Tasks</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="completed-tasks">0</span>
                <span class="stat-label">Completed</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="avg-grace-score">0.0</span>
                <span class="stat-label">Avg GRACE Score</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="total-hours">0</span>
                <span class="stat-label">Total Hours</span>
            </div>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="completion-progress"></div>
        </div>
        
        <div class="matrix-container">
            <div class="quadrant quadrant-2">
                <div class="quadrant-title">
                    📅 SCHEDULE
                    <span class="quadrant-count" id="count-2">0</span>
                </div>
                <div class="quadrant-subtitle">Important • Not Urgent</div>
                <div class="items-list" id="quadrant-2-items"></div>
            </div>
            
            <div class="quadrant quadrant-1">
                <div class="quadrant-title">
                    🔥 DO NOW
                    <span class="quadrant-count" id="count-1">0</span>
                </div>
                <div class="quadrant-subtitle">Important • Urgent</div>
                <div class="items-list" id="quadrant-1-items"></div>
            </div>
            
            <div class="quadrant quadrant-held">
                <div class="quadrant-title">
                    ⏸️ HELD
                    <span class="quadrant-count" id="count-held">0</span>
                </div>
                <div class="quadrant-subtitle">No Resources Available</div>
                <div class="items-list" id="quadrant-held-items"></div>
            </div>
            
            <div class="quadrant quadrant-4">
                <div class="quadrant-title">
                    🚫 DON'T DO
                    <span class="quadrant-count" id="count-4">0</span>
                </div>
                <div class="quadrant-subtitle">Not Important • Not Urgent</div>
                <div class="items-list" id="quadrant-4-items"></div>
            </div>
            
            <div class="quadrant quadrant-3">
                <div class="quadrant-title">
                    👥 DELEGATE
                    <span class="quadrant-count" id="count-3">0</span>
                </div>
                <div class="quadrant-subtitle">Not Important • Urgent</div>
                <div class="items-list" id="quadrant-3-items"></div>
            </div>
        </div>
        
        <div class="time-allocation-chart">
            <div class="chart-title">Weekly Time Allocation</div>
            <div class="pie-chart" id="pie-chart-container">
                <!-- Pie chart will be generated here -->
            </div>
            <div class="chart-legend" id="chart-legend">
                <!-- Legend will be generated here -->
            </div>
        </div>
        
        <div class="input-section">
            <h3>Add New Task</h3>
            <div class="input-group">
                <input type="text" id="item-title" placeholder="Task title...">
                <textarea id="item-description" placeholder="Detailed description (optional)..."></textarea>
                <select id="task-type">
                    <option value="">Select Task Type</option>
                    <option value="Church">⛪ Church</option>
                    <option value="Family">👨‍👩‍👧‍👦 Family</option>
                    <option value="Work">💼 Work</option>
                    <option value="Relationships">🤝 Relationships</option>
                    <option value="Self">🧘 Self</option>
                </select>
                <input type="number" id="estimated-time" placeholder="Est. Hours" min="0.25" step="0.25">
                <input type="number" id="manual-grace-score" placeholder="Manual GRACE Score (0-100)" min="0" max="100" title="Override automatic GRACE scoring">
                <select id="recurrence">
                    <option value="">Select Recurrence</option>
                    <option value="Non-recurring">📅 Non-recurring</option>
                    <option value="Daily">🔄 Daily</option>
                    <option value="Weekly">📊 Weekly</option>
                    <option value="Monthly">🗓️ Monthly</option>
                    <option value="Annually">📆 Annually</option>
                </select>
                <select id="resources">
                    <option value="">Resources Available?</option>
                    <option value="Yes">✅ Yes</option>
                    <option value="No">❌ No</option>
                </select>
                <select id="urgency">
                    <option value="">Select Urgency</option>
                    <option value="high">High Urgency</option>
                    <option value="low">Low Urgency</option>
                </select>
                <select id="importance">
                    <option value="">Select Importance</option>
                    <option value="high">High Importance</option>
                    <option value="low">Low Importance</option>
                </select>
            </div>
            <div class="button-group">
                <button onclick="addItem()">Add Task</button>
                <button onclick="exportData()" class="secondary-btn" title="Export as JSON with full data">📄 Export JSON</button>
                <button onclick="exportToCSV()" class="secondary-btn" title="Export as CSV for Excel/Sheets">📊 Export CSV</button>
                <button onclick="importData()" class="secondary-btn" title="Import JSON or CSV data">📥 Import Data</button>
                <button onclick="clearCompleted()" class="secondary-btn" title="Remove all completed tasks">🗑️ Clear Completed</button>
            </div>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #28a745, #20c997);"></div>
                <span><strong>DO NOW:</strong> Urgent crises requiring immediate action</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #ffc107, #fd7e14);"></div>
                <span><strong>SCHEDULE:</strong> Important work that prevents crises</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #6f42c1, #e83e8c);"></div>
                <span><strong>DELEGATE:</strong> Urgent but less important tasks</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #dc3545, #fd7e14);"></div>
                <span><strong>DON'T DO:</strong> Low-value time wasters</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #e9ecef, #ced4da);"></div>
                <span><strong>HELD:</strong> Blocked by missing resources</span>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>Edit Task</h3>
            <div class="input-group">
                <input type="text" id="edit-title" placeholder="Task title...">
                <textarea id="edit-description" placeholder="Detailed description..."></textarea>
                <select id="edit-task-type">
                    <option value="">Select Task Type</option>
                    <option value="Church">⛪ Church</option>
                    <option value="Family">👨‍👩‍👧‍👦 Family</option>
                    <option value="Work">💼 Work</option>
                    <option value="Relationships">🤝 Relationships</option>
                    <option value="Self">🧘 Self</option>
                </select>
                <input type="number" id="edit-estimated-time" placeholder="Est. Hours" min="0.25" step="0.25">
                <input type="number" id="edit-manual-grace-score" placeholder="Manual GRACE Score (0-100)" min="0" max="100" title="Override automatic GRACE scoring">
                <select id="edit-recurrence">
                    <option value="">Select Recurrence</option>
                    <option value="Non-recurring">📅 Non-recurring</option>
                    <option value="Daily">🔄 Daily</option>
                    <option value="Weekly">📊 Weekly</option>
                    <option value="Monthly">🗓️ Monthly</option>
                    <option value="Annually">📆 Annually</option>
                </select>
                <select id="edit-resources">
                    <option value="">Resources Available?</option>
                    <option value="Yes">✅ Yes</option>
                    <option value="No">❌ No</option>
                </select>
                <select id="edit-urgency">
                    <option value="">Select Urgency</option>
                    <option value="high">High Urgency</option>
                    <option value="low">Low Urgency</option>
                </select>
                <select id="edit-importance">
                    <option value="">Select Importance</option>
                    <option value="high">High Importance</option>
                    <option value="low">Low Importance</option>
                </select>
            </div>
            <div class="button-group">
                <button onclick="saveEdit()">Save Changes</button>
                <button onclick="closeEditModal()" class="secondary-btn">Cancel</button>
            </div>
        </div>
    </div>

    <input type="file" id="import-
